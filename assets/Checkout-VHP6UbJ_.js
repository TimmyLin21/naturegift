import{c as B}from"./cartMixin-DWsFKTG1.js";import{a as T,p as S,h as M}from"./alertMixin-DyMZh6iB.js";import{_ as k,c as d,o as a,b as e,g as n,h as j,d as i,j as y,n as g,F as _,r as E,t as u,f as v,v as w,w as U,e as C,a as q}from"./index-KAsS_BkG.js";const D={data(){return{data:{user:{name:"",email:"",tel:"",address:""},message:""}}},methods:{checkOut(){S(this.data).then(o=>{this.alert.msg="Order created successfully!",this.alert.state=!0,this.sendMsg(),this.$emitter.emit("renewCart"),this.$router.push(`/payment/${o.data.orderId}`)}).catch(()=>{this.alert.msg="Failed to create order!",this.alert.state=!1,this.sendMsg()})},isPhone(o){if(!o)return"Phone number is required.";const t=/^[+\d\s-()]*$/,b=(o.match(/\d/g)||[]).length;return t.test(o)&&b>=8&&b<=20?!0:"Please enter a valid phone number."}},mixins:[T]},z={class:"w-full"},A={class:"col-span-12"},F={class:"col-span-12 md:col-span-6"},$={class:"col-span-12 md:col-span-6"},O={class:"col-span-12"};function L(o,t,b,I,l,r){const m=i("v-field"),f=i("ErrorMessage"),x=i("v-form");return a(),d("section",z,[t[10]||(t[10]=e("h2",{class:"text-2xl font-bold mb-4 text-gray-800"}," Contact Info ",-1)),n(x,{class:"grid grid-cols-12 gap-4 mb-4",onSubmit:r.checkOut},{default:j(({errors:p})=>[e("div",A,[t[4]||(t[4]=e("label",{for:"email",class:"block text-left text-gray-700 font-bold mb-2",name:"Email"},[y("Email "),e("span",{class:"text-red-500"},"*")],-1)),n(m,{"validate-on-input":!1,"validate-on-blur":!1,"validate-on-change":!1,type:"email",id:"email",class:g(["w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-secondary focus:border-transparent transition-all",{"border-red-500 focus:ring-red-500":p.Email}]),name:"Email",rules:"required|email",placeholder:"Please enter email",modelValue:l.data.user.email,"onUpdate:modelValue":t[0]||(t[0]=c=>l.data.user.email=c)},null,8,["class","modelValue"]),n(f,{name:"Email",class:"text-red-500 text-sm mt-1 block"})]),e("div",F,[t[5]||(t[5]=e("label",{for:"name",class:"block text-left text-gray-700 font-bold mb-2",name:"Name"},[y("Name "),e("span",{class:"text-red-500"},"*")],-1)),n(m,{"validate-on-input":!1,"validate-on-blur":!1,"validate-on-change":!1,type:"text",class:g(["w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-secondary focus:border-transparent transition-all",{"border-red-500 focus:ring-red-500":p.Name}]),id:"name",name:"Name",rules:"required",placeholder:"Please enter name",modelValue:l.data.user.name,"onUpdate:modelValue":t[1]||(t[1]=c=>l.data.user.name=c)},null,8,["class","modelValue"]),n(f,{name:"Name",class:"text-red-500 text-sm mt-1 block"})]),e("div",$,[t[6]||(t[6]=e("label",{for:"phone",class:"block text-left text-gray-700 font-bold mb-2",name:"Phone"},[y("Phone "),e("span",{class:"text-red-500"},"*")],-1)),n(m,{"validate-on-input":!1,"validate-on-blur":!1,"validate-on-change":!1,type:"text",class:g(["w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-secondary focus:border-transparent transition-all",{"border-red-500 focus:ring-red-500":p.Phone}]),id:"phone",name:"Phone",rules:r.isPhone,placeholder:"Please enter phone number",modelValue:l.data.user.tel,"onUpdate:modelValue":t[2]||(t[2]=c=>l.data.user.tel=c)},null,8,["class","rules","modelValue"]),n(f,{name:"Phone",class:"text-red-500 text-sm mt-1 block"})]),e("div",O,[t[7]||(t[7]=e("label",{for:"address",class:"block text-left text-gray-700 font-bold mb-2",name:"Address"},[y("Address "),e("span",{class:"text-red-500"},"*")],-1)),n(m,{"validate-on-input":!1,"validate-on-blur":!1,"validate-on-change":!1,type:"text",class:g(["w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-secondary focus:border-transparent transition-all",{"border-red-500 focus:ring-red-500":p.Address}]),id:"address",name:"Address",rules:"required",placeholder:"Please enter address",modelValue:l.data.user.address,"onUpdate:modelValue":t[3]||(t[3]=c=>l.data.user.address=c)},null,8,["class","modelValue"]),n(f,{name:"Address",class:"text-red-500 text-sm mt-1 block"})]),t[8]||(t[8]=e("div",{class:"col-span-12 mb-4"},[e("label",{for:"notes",class:"block text-left text-gray-700 font-bold mb-2",name:""},"Notes"),e("textarea",{class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-secondary focus:border-transparent transition-all",id:"notes",rows:"3",placeholder:"Notes about your order..."})],-1)),t[9]||(t[9]=e("div",{class:"col-span-12 text-center"},[e("button",{class:"bg-secondary text-white px-8 py-3 rounded-full hover:bg-opacity-90 transition-all duration-300 font-bold w-full md:w-auto shadow-md transform hover:-translate-y-1",type:"submit"},[e("span",null,"Checkout")])],-1))]),_:1},8,["onSubmit"])])}const Y=k(D,[["render",L]]),Q={data(){return{couponCode:"",loadingItem:""}},components:{ContactInfo:Y},methods:{applyCoupon(){M(this.couponCode).then(o=>{this.final_total=o.data.data.final_total,this.alert.msg="Coupon applied successfully!",this.alert.state=!0,this.sendMsg()}).catch(()=>{this.alert.msg="Failed to apply coupon!",this.alert.state=!1,this.sendMsg(),this.couponCode=""})},goShop(){this.$router.push("/products")},updateCart(o,t){this.loadingItem!==o.id&&(this.loadingItem=o.id,this.editCart(o,t).finally(()=>{this.loadingItem=""}))},removeCartItem(o){this.loadingItem!==o&&(this.loadingItem=o,this.delCartItem(o).finally(()=>{this.loadingItem=""}))}},mixins:[B]},G={class:"container mx-auto px-4 py-5 mt-[100px] md:mt-[150px]"},H={class:"flex justify-center items-center mb-10 gap-8 lg:gap-20"},J={class:"flex flex-col items-center relative z-10"},K={class:"w-16 h-16 rounded-full bg-secondary text-white flex items-center justify-center mb-2 shadow-lg"},R={class:"flex flex-col items-center relative z-10 text-gray-400"},W={class:"w-16 h-16 rounded-full bg-gray-200 flex items-center justify-center mb-2"},X={class:"flex flex-col items-center relative z-10 text-gray-400"},Z={class:"w-16 h-16 rounded-full bg-gray-200 flex items-center justify-center mb-2"},ee={class:"flex flex-col md:flex-row gap-8"},te={class:"w-full md:w-7/12 mb-4"},se={class:"overflow-x-auto mb-5 rounded-lg shadow-sm border border-gray-100"},oe={class:"w-full text-left border-collapse"},le={class:"divide-y divide-gray-100"},ne={class:"py-3 px-4 w-10"},ae=["onClick"],re={class:"py-3 px-4",width:"100px"},de=["src","alt"],ie={class:"py-3 px-4"},ce={class:"font-medium text-gray-800 mb-0"},ue={class:"text-gray-500"},pe={class:"py-3 px-4"},me={class:"mb-0 text-sm line-through text-gray-400"},fe={class:"mb-0 font-bold text-gray-800"},ge={key:1,class:"mb-0 font-bold text-gray-800"},he={class:"py-3 px-4",width:"15%"},be={class:"flex items-center gap-2 relative"},ye={key:0,class:"absolute inset-0 flex items-center justify-center bg-white bg-opacity-80 z-10 font-bold text-xs"},xe=["onClick","disabled"],_e=["onUpdate:modelValue","onChange","disabled"],ve=["onClick","disabled"],we={class:"py-3 px-4 font-bold text-secondary whitespace-nowrap"},Ce={class:"bg-gray-50 border-t border-gray-100"},ke={colspan:"3",class:"py-3 px-4 text-right"},Ie={key:0,class:"flex flex-col items-end"},Ve={class:"text-gray-400 line-through text-sm"},Ne={class:"text-red-500 font-bold text-lg"},Pe={key:1,class:"text-lg font-bold text-gray-800"},Be={class:"flex gap-2 mb-6"},Te={key:1,class:"text-center py-10"};function Se(o,t,b,I,l,r){const m=i("BIconCart"),f=i("BIconCreditCard"),x=i("BIconStar"),p=i("font-awesome-icon"),c=i("BIconTrash"),V=i("BIconDashCircle"),N=i("BIconPlusCircle"),P=i("ContactInfo");return a(),d("main",G,[e("div",H,[e("div",J,[e("div",K,[n(m,{width:"1.5rem",height:"1.5rem"})]),t[3]||(t[3]=e("p",{class:"font-bold text-gray-800"},"Checkout",-1))]),t[6]||(t[6]=e("div",{class:"h-[2px] w-16 bg-gray-300 -mt-8 hidden md:block"},null,-1)),e("div",R,[e("div",W,[n(f,{width:"1.5rem",height:"1.5rem"})]),t[4]||(t[4]=e("p",null,"Payment",-1))]),t[7]||(t[7]=e("div",{class:"h-[2px] w-16 bg-gray-300 -mt-8 hidden md:block"},null,-1)),e("div",X,[e("div",Z,[n(x,{width:"1.5rem",height:"1.5rem"})]),t[5]||(t[5]=e("p",null,"Finish",-1))])]),e("div",ee,[e("section",te,[e("h2",{class:g(["text-2xl font-bold mb-4",{hidden:o.carts.length===0}])}," Your cart ",2),o.carts.length>0?(a(),d(_,{key:0},[e("div",se,[e("table",oe,[t[9]||(t[9]=e("thead",{class:"bg-gray-50 text-gray-600 uppercase text-xs"},[e("tr",null,[e("th",{scope:"col",colspan:"3",class:"py-3 px-4"},"Product"),e("th",{scope:"col",class:"py-3 px-4"},"Price"),e("th",{scope:"col",class:"py-3 px-4"},"Quantity"),e("th",{scope:"col",class:"py-3 px-4"},"Total")])],-1)),e("tbody",le,[(a(!0),d(_,null,E(o.carts,s=>(a(),d("tr",{key:s.id,class:"bg-white hover:bg-gray-50 transition-colors"},[e("td",ne,[e("a",{href:"#",class:g(["text-red-400 hover:text-red-600 transition-colors",{"opacity-50 cursor-not-allowed":l.loadingItem===s.id}]),onClick:U(h=>r.removeCartItem(s.id),["prevent"])},[l.loadingItem===s.id?(a(),C(p,{key:0,icon:"spinner",spin:""})):(a(),C(c,{key:1}))],10,ae)]),e("td",re,[e("img",{src:s.product.imageUrl,alt:s.product.title,class:"w-20 h-14 object-cover rounded shadow-sm"},null,8,de)]),e("td",ie,[e("p",ce,u(s.product.title),1),e("small",ue,"Size: "+u(s.product.unit),1)]),e("td",pe,[s.product.price!==s.product.origin_price?(a(),d(_,{key:0},[e("p",me," NT$ "+u(s.product.origin_price),1),e("p",fe," NT$ "+u(s.product.price),1)],64)):(a(),d("p",ge," NT$ "+u(s.product.origin_price),1))]),e("td",he,[e("div",be,[l.loadingItem===s.id?(a(),d("div",ye,[n(p,{icon:"spinner",spin:""})])):q("",!0),e("button",{class:"text-gray-500 hover:text-secondary disabled:opacity-50 w-6 h-6 flex items-center justify-center",onClick:h=>r.updateCart(s,"-"),disabled:s.qty<=1||l.loadingItem===s.id},[n(V,{class:"w-5 h-5"})],8,xe),v(e("input",{class:"w-12 text-center border-0 p-0 focus:ring-0 font-bold bg-gray-100 rounded border border-gray-200 h-6 leading-none text-sm",type:"number",min:"1","onUpdate:modelValue":h=>s.qty=h,onChange:h=>r.updateCart(s),disabled:l.loadingItem===s.id},null,40,_e),[[w,s.qty,void 0,{number:!0}]]),e("button",{class:"text-gray-500 hover:text-secondary disabled:opacity-50 w-6 h-6 flex items-center justify-center",onClick:h=>r.updateCart(s,"+"),disabled:l.loadingItem===s.id},[n(N,{class:"w-5 h-5"})],8,ve)])]),e("td",we," NT$ "+u(s.total),1)]))),128))]),e("tfoot",Ce,[e("tr",null,[t[8]||(t[8]=e("td",{colspan:"3",class:"py-3 px-4 font-bold text-right text-gray-600"}," Subtotal ",-1)),e("td",ke,[o.total!==o.final_total?(a(),d("div",Ie,[e("span",Ve,"NTD$ "+u(o.total),1),e("span",Ne,"NTD$ "+u(o.final_total),1)])):(a(),d("div",Pe," NTD$ "+u(o.final_total),1))])])])])]),e("div",Be,[v(e("input",{type:"text",class:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-secondary focus:border-transparent",placeholder:"Coupon Code","onUpdate:modelValue":t[0]||(t[0]=s=>l.couponCode=s)},null,512),[[w,l.couponCode]]),e("button",{class:"px-6 py-2 border border-secondary text-secondary font-bold rounded-lg hover:bg-secondary hover:text-white transition-colors",type:"button",onClick:t[1]||(t[1]=(...s)=>r.applyCoupon&&r.applyCoupon(...s))}," Apply ")])],64)):(a(),d("div",Te,[t[10]||(t[10]=e("p",{class:"font-bold text-2xl text-gray-800 mb-2"}," Your cart is empty ",-1)),t[11]||(t[11]=e("p",{class:"text-gray-500 mb-8"}," Looks like you haven't made a choice yet. ",-1)),e("button",{class:"px-8 py-3 bg-secondary text-white font-bold rounded-full shadow-lg hover:bg-opacity-90 transform hover:scale-105 transition-all",onClick:t[2]||(t[2]=(...s)=>r.goShop&&r.goShop(...s))}," Shop now ")]))]),n(P,{class:"w-full md:w-5/12"})])])}const Ue=k(Q,[["render",Se],["__scopeId","data-v-962b0864"]]);export{Ue as default};
